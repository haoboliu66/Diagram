<mxfile host="app.diagrams.net" modified="2023-10-01T21:29:00.169Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36" etag="B-M-2fesu-O81SWuZAwH" version="22.0.0" type="github">
  <diagram name="Page-1" id="iqe3As87bchgCNZe354T">
    <mxGraphModel dx="1434" dy="765" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-1" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1700" y="210" width="390" height="270" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-2" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1730" y="285" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-5" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1610" y="250" as="sourcePoint" />
            <mxPoint x="1680" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-6" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFF99;" parent="1" vertex="1">
          <mxGeometry x="1730" y="285" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-9" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1860" y="285" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-10" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fontSize=11;fillColor=#FFFF99;" parent="1" vertex="1">
          <mxGeometry x="1860" y="285" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-11" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1980" y="285" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-12" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFF99;" parent="1" vertex="1">
          <mxGeometry x="1980" y="285" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-13" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1540" y="540" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-14" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1600" y="540" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-15" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1660" y="540" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-17" value="为了优化性能, 避免多个线程获取任务时发生竞争, 工作窃取队列使用双端列队, 当前线程从top放入, 其他线程从base拿走" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1755" y="530" width="305" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-18" value="使用CAS避免多个竞争获取同一个&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1745" y="595" width="280" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-19" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1569.62" y="480" as="sourcePoint" />
            <mxPoint x="1569.62" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-20" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1698.23" y="634" as="sourcePoint" />
            <mxPoint x="1698" y="579" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-21" value="top" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1674" y="635" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-22" value="base" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1545" y="455" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-23" value="会有多个线程从base指针窃取, base指针" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1720" y="670" width="305" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="UsoG7qOwd3O0ct9gbPl3-24" target="UsoG7qOwd3O0ct9gbPl3-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-24" value="外部线程提交任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1530" y="210" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-25" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="1730" y="230" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-26" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="1860" y="230" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-27" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="1980" y="230" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-29" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1710" y="400" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-30" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1840" y="400" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-31" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1967.5" y="400" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-38" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="UsoG7qOwd3O0ct9gbPl3-33" target="UsoG7qOwd3O0ct9gbPl3-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-33" value="提交时如何决定提交到哪个队列" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1680" y="120" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-37" value="&quot;负载均衡&quot; - Hashing" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1807.5" y="160" width="185" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-39" value="两个队列读多写少, 优先考虑读性能， 因此使用数组实现" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2207.5" y="250" width="183" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-41" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFF99;" parent="1" vertex="1">
          <mxGeometry x="2230" y="300" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-42" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2310" y="300" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-43" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFF99;" parent="1" vertex="1">
          <mxGeometry x="2390.5" y="300" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-44" value="用奇偶index来区分数组当前元素归属于哪类队列" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2190" y="350" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-45" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2150" y="300" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-1" value="并发专题" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="90" width="630" height="50" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
