<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36" version="26.0.7">
  <diagram name="Page-1" id="iqe3As87bchgCNZe354T">
    <mxGraphModel dx="2921" dy="665" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-228" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="431.99" y="7052.5" width="190.01" height="167.5" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-161" value="100000" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="680" y="5905" width="340" height="215" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-134" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-515" y="5530" width="435" height="180" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-96" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-95" target="51N8JspCCHDJ9Vv9rA9t-92" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-95" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;Happens-Before&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="185" y="5480" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-158" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="462" y="4140" width="628" height="450" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-140" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;textShadow=0;" parent="1" vertex="1">
          <mxGeometry x="1165" y="3490" width="3635" height="1710" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-106" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3143" y="6350" width="652" height="200" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-100" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4115" y="6170" width="405" height="220" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" parent="1" source="FncKr-vtPmwALynlk0jB-15" target="FncKr-vtPmwALynlk0jB-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-15" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1240" y="3500" width="970" height="180" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-13" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1480" y="3230" width="595" height="100" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-21" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1101" y="3490" width="306" height="70" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-1" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1960" y="160" width="390" height="270" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-2" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1990" y="235" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-5" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1870" y="200" as="sourcePoint" />
            <mxPoint x="1940" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-6" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1990" y="235" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-9" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2120" y="235" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-10" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fontSize=11;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2120" y="235" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-11" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2240" y="235" width="80" height="180" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-12" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2240" y="235" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-13" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1800" y="490" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-14" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1860" y="490" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-15" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1920" y="490" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-17" value="为了优化性能, 避免多个线程获取任务时发生竞争, 工作窃取队列使用双端列队, 当前线程从top放入, 其他线程从base拿走" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="2015" y="480" width="305" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-18" value="使用CAS避免多个竞争获取同一个&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="2005" y="545" width="280" height="40" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-19" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1829.62" y="430" as="sourcePoint" />
            <mxPoint x="1829.62" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-20" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1958.23" y="584" as="sourcePoint" />
            <mxPoint x="1958" y="529" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-21" value="top" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1934" y="585" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-22" value="base" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1805" y="405" width="50" height="25" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-23" value="会有多个线程从base指针窃取, base指针" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="2015" y="610" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="UsoG7qOwd3O0ct9gbPl3-24" target="UsoG7qOwd3O0ct9gbPl3-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-24" value="外部线程提交任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1790" y="160" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-25" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="1990" y="180" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-26" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2120" y="180" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-27" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2240" y="180" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-29" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1970" y="350" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-30" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2100" y="350" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-31" value="ForkJoinWorkerThread" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="2227.5" y="350" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-38" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="UsoG7qOwd3O0ct9gbPl3-33" target="UsoG7qOwd3O0ct9gbPl3-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-33" value="提交时如何决定提交到哪个队列" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1940" y="70" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-37" value="&quot;负载均衡&quot; - Hashing" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2067.5" y="110" width="185" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-39" value="两个队列读多写少, 优先考虑读性能， 因此使用数组实现" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2467.5" y="207.5" width="192.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-41" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2490" y="250" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-42" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2570" y="250" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-43" value="工作窃取队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2650.5" y="250" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-44" value="用奇偶index来区分数组当前元素归属于哪类队列" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2450" y="300" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="UsoG7qOwd3O0ct9gbPl3-45" value="外部提交队列" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#CCE5FF;" parent="1" vertex="1">
          <mxGeometry x="2410" y="250" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-1" value="并发专题" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="80" width="630" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="dpeUAHpxACgYPMOwfueQ-2" target="dpeUAHpxACgYPMOwfueQ-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="dpeUAHpxACgYPMOwfueQ-2" target="dpeUAHpxACgYPMOwfueQ-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="dpeUAHpxACgYPMOwfueQ-2" target="dpeUAHpxACgYPMOwfueQ-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-2" value="知识" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="230" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-10" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-3" target="dpeUAHpxACgYPMOwfueQ-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-3" value="知识点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="260" y="165" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-13" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-4" target="dpeUAHpxACgYPMOwfueQ-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-4" value="知识点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="260" y="222.5" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-14" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-5" target="dpeUAHpxACgYPMOwfueQ-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-5" value="知识点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="260" y="285" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-9" value="混沌树" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="485" y="235" width="79" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-15" value="并发的本质: 多个CPU同时操作了同一个数据" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="90" y="410" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-16" value="atomicity: 一段操作, 要么全不执行, 那么全执行完不能被中断" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="385" y="410" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-22" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-17" target="dpeUAHpxACgYPMOwfueQ-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-23" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-17" target="dpeUAHpxACgYPMOwfueQ-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-17" value="CPU如何支持原子性操作" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="100" y="510" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-18" value="锁总线" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="330" y="485" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-21" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-19" target="dpeUAHpxACgYPMOwfueQ-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-19" value="锁缓存行" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="330" y="540" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-20" value="锁一个变量的虚拟地址" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="460" y="540" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-24" value="CPU提供指令级别的原子性操作" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="280" y="590" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-25" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="498.75" y="880" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-26" value="OS" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="498.75" y="830" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-29" value="基于CPU的单个原子指令实现原子性操作" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="740" y="835" width="214" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-30" value="App" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="552" y="771" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-31" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="611.25" y="880" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-32" value="Monitor&lt;br&gt;管程" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="370.75" y="830" width="60" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-33" value="lock; cmpxchg" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="135" y="1370" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-36" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-35" target="dpeUAHpxACgYPMOwfueQ-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-35" value="CAS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="160" y="1310" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-37" value="SMP架构" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="130" y="1100" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-38" value="NUMA架构" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="240" y="1100" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-39" value="mechanism for carrying out locked atomic operations:&lt;br&gt;1. Guaranteed atomic operations&lt;br&gt;2. Bus locking, using LOCK signal and the LOCK instruction prefix&lt;br&gt;3. Cache coherency protocols (MESI)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="460" y="1075" width="333" height="70" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-42" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-40" target="dpeUAHpxACgYPMOwfueQ-41" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-40" value="ABA问题" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontFamily=Helvetica;fontColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="309" y="1314" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="dpeUAHpxACgYPMOwfueQ-41" target="dpeUAHpxACgYPMOwfueQ-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-41" value="引入一个counter, 改了就+1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="417" y="1314" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-47" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-43" target="dpeUAHpxACgYPMOwfueQ-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-43" value="AtomicStampedReference" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="599" y="1314" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-46" value="把counter和要修改的变量打包" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="739" y="1250" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-48" value="ClassLoader: 线程上下文加载器的二义性问题?" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1385" y="690" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-49" value="java.sql.DriverManager" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1435" y="771" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-51" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="dpeUAHpxACgYPMOwfueQ-50" target="dpeUAHpxACgYPMOwfueQ-49" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-50" value="rt.jar" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1325" y="771" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dpeUAHpxACgYPMOwfueQ-52" value="是由bootloader加载的, 而JDBC的驱动由第三方实现, 所以通过线程上下文加载器告诉bootloader去加载该类, 因为bootloader不知道这个类在哪加载" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1265" y="811" width="440" height="39" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="HeV-wAqHhQqOec4LPYSm-1" target="dpeUAHpxACgYPMOwfueQ-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-1" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="30" y="1365" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-3" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="227" y="1323.5" as="sourcePoint" />
            <mxPoint x="297" y="1323.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1130" y="1650" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-11" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1130" y="1670" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-12" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1130" y="1690" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="HeV-wAqHhQqOec4LPYSm-13" target="HeV-wAqHhQqOec4LPYSm-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-13" value="若不同的Cell在一个缓存行中, 此时又会退化为原来的CAS操作, 于是我们希望将他们分布在不同缓存行中, 利用锁分散的机制增加并行度, 如何做? 缓存行填充, e.g. 缓存行大小64byte, int只用4byte, 于是要填充60byte" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1350" y="1660" width="410" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-15" value="Java中, 通过@Contended由编译器或运行时自动填充" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1420.25" y="1740" width="269.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-17" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1130" y="1710" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-18" value="cache line" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1175" y="1620" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-19" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1200" y="1650" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-20" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1200" y="1670" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-21" value="缓存行锁代替总线锁的唯一条件: 变量已在缓存行中" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1420.25" y="1630" width="269.75" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-22" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1289" y="1300" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-24" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1420" y="1300" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-25" value="CPU3" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1549" y="1300" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-28" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1549" y="1330" width="70" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-29" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1420" y="1330" width="70" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-30" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1289" y="1330" width="70" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-31" value="变量A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1294" y="1355" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-32" value="变量A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1425" y="1355" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-33" value="变量A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1554" y="1355" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="HeV-wAqHhQqOec4LPYSm-35" target="HeV-wAqHhQqOec4LPYSm-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-35" value="当变量A被加载到多个CPU cache中时, 执行lock操作将会使用MESI协议来保证只有一个CPU可以对变量A进行cmpxchg" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1265" y="1405" width="409" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="HeV-wAqHhQqOec4LPYSm-36" target="HeV-wAqHhQqOec4LPYSm-38" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-36" value="随着CPU数量增多, 大量CPU的CAS失败, 进行无谓的自旋" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1320" y="1480" width="299" height="25" as="geometry" />
        </mxCell>
        <mxCell id="HeV-wAqHhQqOec4LPYSm-38" value="锁分散" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontFamily=Helvetica;fontColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1199" y="1576" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="SonHGdceE0Zbm2Z1TKrk-5" target="r9cip8CiFLFCaYMpcU3F-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="SonHGdceE0Zbm2Z1TKrk-5" value="volatile" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=16;fontColor=#FF3333;" parent="1" vertex="1">
          <mxGeometry x="621" y="2040" width="99" height="40" as="geometry" />
        </mxCell>
        <mxCell id="SonHGdceE0Zbm2Z1TKrk-32" value="mmIO" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="830.5" y="1990" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="SonHGdceE0Zbm2Z1TKrk-33" value="CPU乱序执行现象" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="786" y="2610" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="TZ7YPI2pEZnhK35bZtsi-1" target="AeaUYEnInn6TyFFDgCMk-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TZ7YPI2pEZnhK35bZtsi-1" value="CPU在执行指令时, 没有按照编码顺序执行的现象, i.e. 指令之间相对顺序发生了改变" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="915" y="2615" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-1" value="简化了重排序的行为, 告诉Java开发者编码规则, 至于底层怎么实现是JVM开发者的问题" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1693" y="2050" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-2" target="AeaUYEnInn6TyFFDgCMk-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-2" value="JMM" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1549" y="2050" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-4" target="AeaUYEnInn6TyFFDgCMk-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-4" value="Java" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1549" y="1990" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="AeaUYEnInn6TyFFDgCMk-8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1070" y="2700" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-6" value="CPU和编译器都可能导致重排序" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="982.5" y="2680" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-8" target="2cmjIInxjt0Y60UCOrVg-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-8" value="特定的CPU和编译器带来的重排序行为都不太一样" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="945" y="2740" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-10" target="B9yCGMFFLdolYYt0oWos-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-10" target="B9yCGMFFLdolYYt0oWos-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-10" value="研究范围限定于: Intel 和 gcc" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;textShadow=0;" parent="1" vertex="1">
          <mxGeometry x="1230" y="2740" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-12" target="AeaUYEnInn6TyFFDgCMk-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-12" value="屏障" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="853.5" y="3092.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="AeaUYEnInn6TyFFDgCMk-13" target="AeaUYEnInn6TyFFDgCMk-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-13" value="隔离指令" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="996.81" y="3092.5" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-19" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="AeaUYEnInn6TyFFDgCMk-15" target="AeaUYEnInn6TyFFDgCMk-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-15" value="STORE A&lt;br&gt;屏障&lt;br&gt;STORE B" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1106" y="3080" width="90" height="55" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-21" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="AeaUYEnInn6TyFFDgCMk-17" target="AeaUYEnInn6TyFFDgCMk-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-17" value="隔离屏障两边的指令, 使他们满足该屏障所能保证的意义" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1298.5" y="3112.5" width="285" height="40" as="geometry" />
        </mxCell>
        <mxCell id="AeaUYEnInn6TyFFDgCMk-20" value="那么有哪几种屏障, 某种屏障要保证的意义是什么?" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1306" y="3172.5" width="270" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="99BcAxhjOU1GVthHqTRR-1" target="99BcAxhjOU1GVthHqTRR-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-13" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="99BcAxhjOU1GVthHqTRR-1" target="99BcAxhjOU1GVthHqTRR-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-15" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=default;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;" parent="1" source="99BcAxhjOU1GVthHqTRR-1" target="99BcAxhjOU1GVthHqTRR-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-1" value="barriers" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="647" y="3310" width="79" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-2" value="store barriers" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="856" y="3252.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="99BcAxhjOU1GVthHqTRR-4" target="B9yCGMFFLdolYYt0oWos-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-4" value="保证2个或2组写操作的相对顺序, store barrier之后的写指令不会重排序到barrier前的写指令之前" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="966" y="3245" width="474" height="45" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-6" value="前提: 所有的内存操作指令, 等价于向内存提交一组 操作队列" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1565" y="3340" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-11" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;fillColor=#fff2cc;" parent="1" source="99BcAxhjOU1GVthHqTRR-7" target="99BcAxhjOU1GVthHqTRR-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-7" value="STORE A&lt;br&gt;&lt;br&gt;STORE BARRIER&lt;br&gt;&lt;br&gt;STORE B" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="1511" y="3242.5" width="94" height="70" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-10" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;labelBackgroundColor=default;strokeColor=#d6b656;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;endArrow=classic;fillColor=#fff2cc;" parent="1" source="99BcAxhjOU1GVthHqTRR-8" target="99BcAxhjOU1GVthHqTRR-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-8" value="barrier保证A和B的提交顺序" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="1645" y="3262.5" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-9" value="CPU看到了B的最新值, 一定看到了A的最新值" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="1826" y="3262.5" width="235" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-12" value="load barriers" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="853.5" y="3310" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-14" value="full barriers" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="851" y="3366.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-16" value="只保证读操作" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="963.5" y="3312.5" width="80" height="27.5" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-17" value="同时保证读和写" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="961" y="3367.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-18" value="虚拟地址" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1085" y="3520" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-19" value="物理地址" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-916" y="3520" width="105" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-20" value="cache line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1075" y="3590" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-22" value="每个进程虚拟地址一样, 如果用虚拟地址查cache line, 可能发生冲突" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1270" y="3620" width="145" height="40" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-23" value="Direct-mapped caches" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-702.25" y="3570" width="112.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-24" value="Set associative caches" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-716" y="3600" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="99BcAxhjOU1GVthHqTRR-25" value="Fully associative caches" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-716" y="3630" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="GM-Ud_aDfbjV712TQ6Kv-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="GM-Ud_aDfbjV712TQ6Kv-1" target="GM-Ud_aDfbjV712TQ6Kv-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GM-Ud_aDfbjV712TQ6Kv-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="GM-Ud_aDfbjV712TQ6Kv-1" target="GM-Ud_aDfbjV712TQ6Kv-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GM-Ud_aDfbjV712TQ6Kv-1" value="virtual address查询cache的问题" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1300" y="3762" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="GM-Ud_aDfbjV712TQ6Kv-2" value="ambiguity" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1049" y="3752" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="GM-Ud_aDfbjV712TQ6Kv-3" value="alias" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1043.5" y="3792" width="69" height="20" as="geometry" />
        </mxCell>
        <UserObject label="https://zhuanlan.zhihu.com/p/107096130" link="https://zhuanlan.zhihu.com/p/107096130" id="GM-Ud_aDfbjV712TQ6Kv-6">
          <mxCell style="text;whiteSpace=wrap;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
            <mxGeometry x="-1310" y="3712" width="220" height="30" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="PCTluO6xD0Zs3hzz5Vkr-1" value="第7节, 第8节" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1265" y="3540" width="110" height="35" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-2" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2040" y="1302.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2040" y="1332.5" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-8" value="A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2048" y="1347.5" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-9" value="B" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2094" y="1347.5" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-10" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2200" y="1302.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-11" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2200" y="1332.5" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-12" value="A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2208" y="1347.5" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-13" value="B" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2254" y="1347.5" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-14" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="2040" y="1407.5" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-15" value="A" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2125" y="1420" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-16" value="B" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2171" y="1420" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-17" value="Memory" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2043" y="1420.5" width="40" height="25" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-19" value="CPU1写A和B的两种机制:&amp;nbsp;&lt;br style=&quot;font-size: 12px;&quot;&gt;1. 直接把最新值写入内存, 然后告诉CPU2缓存失效&lt;br style=&quot;font-size: 12px;&quot;&gt;2. 直接把最新值写入内存, 然后最新值给CPU2, 似的CPU缓存行中的A和B更新为最新, 此时CPU2无须去内存重新读取" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="2340" y="1310" width="360" height="90" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-20" value="每个原子性的变量, 也即多个线程共享的都加上volatile, 原因何在？" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=14;fontColor=#FF3333;" parent="1" vertex="1">
          <mxGeometry x="774" y="2040" width="436" height="40" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-22" value="JVM" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="845" y="2100" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-23" value="OS" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="845" y="2150" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-24" value="CPU (Intel)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="845" y="2200" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-26" value="CPU 1&lt;br&gt;A == 1&lt;br&gt;A = 3&lt;div&gt;B = 4&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="810" y="2310" width="70" height="100" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-27" value="CPU2&lt;br&gt;B == 2&lt;br&gt;x = A&lt;br&gt;y = B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="920" y="2310" width="67" height="100" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="r9cip8CiFLFCaYMpcU3F-28" target="r9cip8CiFLFCaYMpcU3F-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-28" value="所有CPU的操作, 等价于向内存提交一组访问序列而已" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1013" y="2480" width="305" height="30" as="geometry" />
        </mxCell>
        <mxCell id="r9cip8CiFLFCaYMpcU3F-29" value="指令以何种顺序读内存, 以何种顺序写内存" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1351.5" y="2480" width="240.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hfoLQT2eYCwfNi6susUt-2" value="JUC LongAdder" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1340" y="1560" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-1" value="STORE A 3&lt;br&gt;&lt;br&gt;STORE B 4&lt;br&gt;&lt;br&gt;LOAD A&lt;br&gt;&lt;br&gt;LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1025" y="2310" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-2" value="STORE A 3&lt;br&gt;&lt;br&gt;LOAD A&lt;br&gt;&lt;br&gt;STORE B 4&lt;br&gt;&lt;br&gt;LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1170" y="2310" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-5" value="LOAD A&lt;br&gt;&lt;br&gt;STORE A 3&lt;br&gt;&lt;br&gt;STORE B 4&lt;br&gt;&lt;br&gt;LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1294" y="2310" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-6" value="LOAD A&lt;br&gt;&lt;br&gt;LOAD B&lt;br&gt;&lt;br&gt;STORE A 3&lt;br&gt;&lt;br&gt;STORE B 4" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1425" y="2310" width="110" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-7" value="{3,4}" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1045" y="2270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-8" value="{3,4}" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1195" y="2270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-9" value="{1,4}" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1320" y="2270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-10" value="{1,2}" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1450" y="2270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-11" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;rotation=90;" parent="1" vertex="1">
          <mxGeometry x="1270" y="2220" width="20" height="480" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-13" value="什么导致了这个乱序执行现象?" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="779" y="2680" width="175" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9GSOo7D7u0mSWAOutGfX-14" value="CPU乱序执行的前提是, 不能打破逻辑, 如果变量或逻辑之间没有依赖, 那么才可以乱序" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="705.38" y="2560" width="271.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="2cmjIInxjt0Y60UCOrVg-2" value="JVM是一个中间层, 引入自己的逻辑来屏蔽这些C开发多线程多种复杂的情况, 简化了导致重排序的行为; 这个就是JMM的由来" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="953.75" y="2871" width="232.5" height="52" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="2cmjIInxjt0Y60UCOrVg-3" target="2cmjIInxjt0Y60UCOrVg-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="2cmjIInxjt0Y60UCOrVg-3" value="C, C++需要处理的重排序情况比较复杂, 导致多线程开发的复杂性" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="942.5" y="2810" width="255" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-6" value="JMM约束了Java的行为, Java开发者按照规则编程即可, 具体的实现由JVM开发者负责" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1220" y="2878" width="245" height="38" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-8" value="Intel manual" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;textShadow=0;" parent="1" vertex="1">
          <mxGeometry x="1444" y="2710" width="86" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-9" value="gcc manual" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;textShadow=0;" parent="1" vertex="1">
          <mxGeometry x="1444.25" y="2770" width="81.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B9yCGMFFLdolYYt0oWos-12" value="由于OS要对接不同的CPU, 那么必然要满足不同的CPU提供的屏障实现要求, 因此通过宏定义来适配不同的CPU" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Helvetica;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="1291" y="3060" width="285" height="40" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-1" value="Memory" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1307.5" y="3620" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-2" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1374" y="3530" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-3" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1480" y="3530" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-4" value="顺序写了" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1306" y="3542" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="FncKr-vtPmwALynlk0jB-5" target="FncKr-vtPmwALynlk0jB-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-5" value="不按顺序读" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1541" y="3542.5" width="86.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-6" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1506.5" y="3625" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-7" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1553.5" y="3625" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FncKr-vtPmwALynlk0jB-8" target="FncKr-vtPmwALynlk0jB-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-8" value="可能会导致某一个值无法读到最新的" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1690" y="3590" width="210" height="28" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-10" value="LOAD B操作重排序到 LOAD A 之前" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1689.75" y="3550" width="210.25" height="28" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-11" value="需要读屏障, 保证LOAD A一定发生在LOAD B 前" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1934" y="3590" width="280" height="28" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-13" value="写屏障, 保证了 STORE A一定发生在STORE B 前" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1239.25" y="3590" width="280" height="28" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-57" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="FncKr-vtPmwALynlk0jB-16" target="-FcQdrV0vnWtqaeG2UPR-56" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FncKr-vtPmwALynlk0jB-16" value="以上是抽象概念. 实际在CPU中呢?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1632.5" y="3740" width="185" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-2" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1201" y="3830" width="889" height="240" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-3" value="Memory" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1315" y="4010" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-4" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1380" y="3850" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-5" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1486" y="3850" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-6" value="顺序写了" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1314" y="3890" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-9" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1514" y="4015" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-10" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1561" y="4015" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-15" value="写屏障, 保证了 STORE A一定发生在STORE B 前" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1210" y="3982" width="280" height="28" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-17" value="cache" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1380" y="3914" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-18" value="cache" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1486" y="3914" width="61" height="42" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-19" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1371.5" y="3940" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-20" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1418.5" y="3940" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-21" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1478" y="3940" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-22" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1525" y="3940" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-23" value="缓存的一致性?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1591" y="3920" width="91" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-24" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="-1184.5" y="3902" width="220" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-26" value="virtual addr" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1184.5" y="3934" width="103" height="38" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-27" value="physical addr" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1067.5" y="3934" width="103" height="38" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-28" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1183" y="4002" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-29" value="用哪个地址去查cache?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1146.5" y="3972" width="144" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-30" target="-FcQdrV0vnWtqaeG2UPR-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-42" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-30" target="-FcQdrV0vnWtqaeG2UPR-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-30" value="virtual addr" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1275" y="4142" width="103" height="38" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-31" target="-FcQdrV0vnWtqaeG2UPR-36" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-138" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-31" target="-FcQdrV0vnWtqaeG2UPR-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-31" value="进程的虚拟地址空间是相同的, 但是两个相同的虚拟地址映射到不同的物理地址, 可能进程A用地址12345读数据到了cache, 然后切换了进程B, 碰巧进程B也用地址12345读cache, 访问到的是进程A读的数据" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-971" y="4082" width="456" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-32" value="但是如果发生context switch, 必须刷cpu的缓存, 避免cache的访问冲突" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-455" y="4122" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-34" value="physical addr" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1272.5" y="4292" width="103" height="38" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-35" value="物理地址是唯一的, 用物理内存查cache, 那么必须要通过MMU -&amp;gt; page table进行地址转换, 为了加速这个过程, 引入TLB" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1158" y="4297" width="646" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-36" value="节省了查page table的时间" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-465" y="4072" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-38" value="共享页, 两个不同的虚拟地址指向同一个物理地址, 但是2个虚拟地址的index不同, ie.指向不同的缓存行, 所以一个物理地址可能被加载到不同的缓存行中" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-971" y="4182" width="456" height="50" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-39" value="ambiguity" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1083" y="4102" width="76" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-40" value="alias" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-1081.5" y="4180" width="76" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-43" value="CPU1如何正确的把数据同步给CPU2的cache" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1689.75" y="3920" width="269" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-44" value="1, CPU1写最新值到内存, 然后通知CPU2缓存失效, 让CPU2自己去读最新值&lt;br&gt;2, CPU1写最新值到内存, 并转发最新值给CPU2" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1680" y="3960" width="414" height="50" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-45" value="Cache Bank" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2735" y="3505.75" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-46" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2410" y="3566.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-47" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2410" y="3596.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-48" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2410" y="3626.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-49" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2410" y="3656.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-50" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2726.5" y="3566.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-51" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2726.5" y="3596.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-52" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2726.5" y="3626.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-53" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2726.5" y="3656.25" width="119" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-54" value="Cache Bank" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2425" y="3503.75" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-55" value="写屏障和读屏障需要配对使用, 写屏障保证了写出顺序, 读屏障保证了 数据可见" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=15;fontColor=#FF0000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2114.5" y="3940" width="319" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-60" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-56" target="-FcQdrV0vnWtqaeG2UPR-59" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-56" value="实际CPU中发生的情况可能是: CPU2读到了B的最新值, 但是没有读到A的最新值。&lt;br&gt;发生这种现象的原因是: CPU2的对于A的最新值不可见, i.e A的更新操作由于cache的繁忙没有及时更新到cache中, 导致CPU2对于这个最新值不可见。造成了一种指令重排序的错觉" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1860" y="3723.75" width="444.5" height="62.5" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-59" value="因此, 使用读屏障保证的是: 让CPU2的cache完成所有的更新操作(清除cache的操作队列, 保证后续无更新操作), 这样的操作就确保了更新A的操作一定落到了cache中, 对CPU2可见" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2350" y="3723.75" width="444.5" height="62.5" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-61" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="2370" y="4270" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-64" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2370" y="4350" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-67" value="Memory" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2370" y="4470" width="490" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-68" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="2690" y="4270" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-69" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2690" y="4350" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-71" value="MESI规则: 写变量时, 若缓存行中不存在改变量, 那么需要将该值先从内存中载入缓存行, 才能写入" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2870" y="4350" width="490" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-72" value="Store Buffer" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2370" y="4319" width="170" height="32" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-76" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-73" target="-FcQdrV0vnWtqaeG2UPR-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-73" value="流水线节点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2264.5" y="4155" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-77" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-74" target="-FcQdrV0vnWtqaeG2UPR-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-74" value="流水线节点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2419.5" y="4155" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-79" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-75" target="-FcQdrV0vnWtqaeG2UPR-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-75" value="流水线节点" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2569" y="4155" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-78" value="避免流水线写操作阻塞" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2491.5" y="4215" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-80" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2591" y="4110" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-81" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2638" y="4110" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-82" value="引入StoreBuffer异步操作" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2625.5" y="4215" width="134.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-83" value="Store Buffer" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2689.5" y="4320" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-84" value="Invalid&amp;nbsp;&lt;span style=&quot;font-size: 11px; background-color: rgb(255, 255, 255);&quot;&gt;Queue&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2370" y="4410" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-123" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-85" target="-FcQdrV0vnWtqaeG2UPR-122" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-85" value="Invalid&amp;nbsp;&lt;span style=&quot;font-size: 11px; background-color: rgb(255, 255, 255);&quot;&gt;Queue&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2689.5" y="4410" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-89" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2870" y="4796.5" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-90" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3037" y="4798" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-91" value="C" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3090" y="4797" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-92" value="D" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3140" y="4798" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-98" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-94" target="-FcQdrV0vnWtqaeG2UPR-97" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-94" value="数据依赖屏障" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2915" y="4793" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-96" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-95" target="-FcQdrV0vnWtqaeG2UPR-94" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-95" value="内核定义的" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2915" y="4728" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-97" value="数据依赖屏障是简化版的读屏障, 它对存在分支的情况不管用, 如果依赖前后存在分支, 那么一定要使用读屏障" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2980" y="4884.5" width="171" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-99" value="JUC 7,8节" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="725" y="2980" width="1145" height="50" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-100" value="假设变量 a b c d&lt;br style=&quot;font-size: 12px;&quot;&gt;在Intel CPU中, 使用putOrdered保证a b c写入顺序(Release), 当访问了volatile变量d时, 会加上lock操作, 根据手册的内容, 将会把可能存在于store buffer中的变量按顺序刷出, 由于intel的store buffer不会发生乱序现象, 所以membar_release也即空操作" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=12;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3308" y="4125" width="408" height="90" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-101" value="如果这个流水线发生写操作阻塞, 整个流水线就被阻塞" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2689.5" y="4150" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-104" value="如果A在cache中, A直接写入cache&lt;br&gt;B不在cache中, B暂存到store buffer, 从内存中加载B到缓存行, 再把B从store buffer写出去" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2085" y="4260" width="225" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-105" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2565" y="4278" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-106" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="2611.5" y="4278" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-107" value="按顺序写A和B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1984" y="4315" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-109" value="如果A不在cache中, B在cache中, A和B都暂存到store buffer(不会直接写B), 从内存中加载A到缓存行, 再把A和B从store buffer写出去; 这A和B一起等的操作是Intel CPU的特性, 保证了写的顺序" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2083" y="4330" width="245" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-110" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-107" target="-FcQdrV0vnWtqaeG2UPR-107" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-111" value="所以在JVM的中x86的store barrier为空操作" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2095" y="4407.5" width="245" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-112" value="如果一个CPU的ISA实现是, 在cache中的数据直接就写出去, e.g. 先写A再写B, B已经在cache中, 直接写B了, 这样就导致了写的顺序不对. 此时就需要store barrier来强制保证write order" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2075" y="4500" width="245" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-116" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="-FcQdrV0vnWtqaeG2UPR-113" target="-FcQdrV0vnWtqaeG2UPR-115" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-113" value="MESI是一种cache coherency protocol, 那么2个cache之间通信是不是需要队列?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2870" y="4405" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-115" value="Invalid Queue" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3110" y="4490" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-117" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2505" y="4415" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-118" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2548.75" y="4415" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-119" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2653.63" y="4415" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-120" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2697.38" y="4415" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-FcQdrV0vnWtqaeG2UPR-122" value="当CPU2在Invalid Queue中暂存了CPU1发来的数据, CPU2从里面取值的时候有没有可能是乱序的? 如果允许乱序, 那么就发生了读的乱序, 需要load barrier来限制; 在Intel CPU中, 这个Invalid Queue的读取也是有序的, 所以JVM x86的load barrier也为空操作" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2505" y="4560" width="430" height="62" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-8" value="假设CPU1通知CPU2, 发送失效A, 失效B两个请求;&lt;br&gt;两个请求进入了Invalid Buffer&amp;nbsp;&lt;div&gt;CPU2先执行了LOAD A, LOAD B, 导致读到了旧值;&lt;br&gt;或者&lt;/div&gt;&lt;div&gt;CPU2先处理了失效A, 然后再LOAD A, 就读到A新值, B旧值&lt;br&gt;或者&lt;br&gt;CPU2处理了2个失效请求, 然后再LOAD, 就都读到了新值&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4050" y="4540" width="380" height="115" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-9" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="3580" y="4545" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-10" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3580" y="4625" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-11" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="3834" y="4545" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-12" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3834" y="4625" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-13" value="Store Buffer" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3580" y="4583" width="170" height="32" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-14" value="Store Buffer" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3834" y="4575" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-15" value="Invalid Queue" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3580" y="4685" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-16" value="Invalid Queue" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="3833.5" y="4685" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-42" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-21" target="wvUFbZKzVNe_2dA4ze0a-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-21" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3750" y="4750" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-22" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3720" y="4750" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-23" value="STORE A&lt;div&gt;STORE B&lt;/div&gt;&lt;div&gt;STORE C&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3635" y="4465" width="70" height="75" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-24" value="load barrier就保证, 在LOAD A时, invalid queue会被清空, 所以当LOAD B时, 一定会拿到新值" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4050" y="4676" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-31" value="这里的data dependency barrier只保证A和B的顺序, 对C和D无效" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2794.5" y="4844.5" width="171" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-32" value="e.g. Store Buffer, Load Buffer, Invalid Buffer" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="790" y="3752" width="155" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-40" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-36" target="wvUFbZKzVNe_2dA4ze0a-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-36" value="A" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3460" y="4630" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-37" value="B" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3430" y="4630" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-38" value="C" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="3350" y="4630" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-39" value="C" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3640" y="4750" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-43" value="LOAD C&lt;div&gt;LOAD A&lt;/div&gt;&lt;div&gt;LOAD B&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3890" y="4465" width="70" height="75" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-44" value="发布release" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3445" y="4665" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-45" value="订阅acquire" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3735" y="4795" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-47" value="初始A, B, C都等于0, 写A = 1, B = 1, C = 1; 读时, 要确保:如果C等于1, 那么A和B一定都等于1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3585" y="4435" width="475" height="34" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-51" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-48" target="wvUFbZKzVNe_2dA4ze0a-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-48" value="Store Barrier" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;fillColor=#FFCC99;" parent="1" vertex="1">
          <mxGeometry x="3380" y="4630" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-53" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-49" target="wvUFbZKzVNe_2dA4ze0a-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-49" value="Load Barrier" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;fillColor=#FFCC99;" parent="1" vertex="1">
          <mxGeometry x="3670" y="4750" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-50" value="确保了写操作在Store Buffer中的顺序" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3310" y="4720" width="190" height="38.5" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-52" value="确保了CPU2在Load B时会明确知道失效自己的cache, 然后处理Invalid Queue的请求, 从而读取从CPU1同步或从内存读取最新的数据,所以CPU2会看到B和A的最新数据" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3627" y="4860" width="233" height="50" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-56" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-54" target="wvUFbZKzVNe_2dA4ze0a-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-54" value="以上由于store buffer和invalid queue是MOB导致的乱序; CPU为了提升执行性能, 是允许乱序执行指令的; load a, load b, store c, load d =&amp;gt; load a, load b, load d, store c&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3368.5" y="4970" width="358" height="50" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-55" value="这个是真实的CPU乱序执行指令, 是最本质的指令乱序" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=12;fontColor=default;labelBackgroundColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="3766.5" y="4980" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-59" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-57" target="wvUFbZKzVNe_2dA4ze0a-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-57" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=data:image/png,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;" parent="1" vertex="1">
          <mxGeometry x="3326.5" y="5060" width="663.08" height="20" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-58" value="间接说明:对于Intel CPU, 锁, 序列化, 和I/O指令本身具备全屏障的作用" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=#FF0000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3432.75" y="5139.5" width="353.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-63" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-60" target="wvUFbZKzVNe_2dA4ze0a-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-60" value="软件开发" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="487" y="3638" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-61" value="执行结果" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="740" y="3638" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-64" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-62" target="wvUFbZKzVNe_2dA4ze0a-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-66" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="wvUFbZKzVNe_2dA4ze0a-62" target="wvUFbZKzVNe_2dA4ze0a-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-62" value="一系列指令" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="611.25" y="3618" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-65" value="CPU乱序执行指令 Or MOB" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="578.25" y="3730" width="146" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-67" value="STORE x" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4267.25" y="5005.5" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-68" value="STORE y" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4337.25" y="5005.5" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wvUFbZKzVNe_2dA4ze0a-69" value="Intel-64 memory-ordering model规定了, 单CPU上的write操作不会乱序; 所以Store x, Store y一定是按顺序发生;&amp;nbsp;&lt;br&gt;另一方面Intel的Store Buffer也保证: 后续的写操作要等前面的写操作执行完成, 才能执行写内存, 从而也保证了x的值一定先于y进入内存" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4227.25" y="4911" width="260" height="84.5" as="geometry" />
        </mxCell>
        <mxCell id="E4f6vcsmDczpbreKZe59-1" value="Cache Line" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-1183" y="4032" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="E4f6vcsmDczpbreKZe59-2" value="Intel CPU保证了单处理器的指令执行顺序, 在多处理器的情况下, 每个CPU指令的相对顺序不会改变 (只会出现由于并发产生的穿插执行)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4178.25" y="5066" width="321.75" height="49" as="geometry" />
        </mxCell>
        <mxCell id="E4f6vcsmDczpbreKZe59-3" value="Cache Coherency Protocol" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3795" y="5430" width="450" height="30" as="geometry" />
        </mxCell>
        <mxCell id="E4f6vcsmDczpbreKZe59-4" value="抽象模型 + 具体实现" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3885" y="5480" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-1" value="若一个SMP系统中, CPU中存在缓存, 那么CPU必须实现多个CPU缓存的数据一致性, 不然会导致严重的问题" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3795" y="5570" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-3" value="若多个处理器同时修改一个cache line, CPU的一致性协议会自己处理这个冲突, 给cache line上锁" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3795" y="5630" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-4" target="sthXmhu9q4Z8TcD6EFiC-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-4" value="Write Propogation criteria" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4145" y="5560" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-8" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-5" target="sthXmhu9q4Z8TcD6EFiC-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-5" value="理想情况下: 缓存一致性可以实现, 写了就马上传播, 且马上成功;&amp;nbsp;&lt;br&gt;但是现实很骨感" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4175" y="5660" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-13" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-7" target="sthXmhu9q4Z8TcD6EFiC-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-14" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-7" target="sthXmhu9q4Z8TcD6EFiC-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-15" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-7" target="sthXmhu9q4Z8TcD6EFiC-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-7" value="BASE理论" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4605" y="5660" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-10" value="Basically Available" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4745" y="5600" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-11" value="Soft State" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4745" y="5640" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-12" value="Eventually Consistent" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4745" y="5690" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-16" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4365" y="5760" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-17" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4474" y="5760" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-18" value="CPU3" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4585" y="5760" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-19" value="CPU4" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4695" y="5760" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-24" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-20" target="sthXmhu9q4Z8TcD6EFiC-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-20" value="store a = 10" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4365" y="5810" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-21" value="store a = 20" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4474" y="5810" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-22" value="load a = 10" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4585" y="5810" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-23" value="load a = 20" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4695" y="5810" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-25" value="CPU3没有处理完invalid queue的所有消息&lt;br&gt;CPU4处理了整个invalid queue" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4585" y="5875" width="220" height="45" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-27" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=90;size=0.5;" parent="1" vertex="1">
          <mxGeometry x="4666.75" y="5800" width="20" height="120" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-28" value="CPU1" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4370" y="5940" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-29" value="CPU2" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4479" y="5940" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-30" value="CPU3" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4590" y="5940" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-31" value="CPU4" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4700" y="5940" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-32" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-33" target="sthXmhu9q4Z8TcD6EFiC-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-33" value="store a = 10" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4370" y="5990" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-34" value="store a = 20" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4479" y="5990" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-35" value="load a = 10" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4590" y="5990" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-36" value="load a = 20" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4700" y="5990" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-37" value="如果CPU1和CPU2向内存同一区域分别store A = 10和store A = 20, 缓存一致性协议必须保证这个写入顺序" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4350" y="6040" width="330" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-38" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=90;size=0.5;" parent="1" vertex="1">
          <mxGeometry x="4445" y="5970" width="20" height="120" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-101" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-40" target="sthXmhu9q4Z8TcD6EFiC-100" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-103" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-40" target="sthXmhu9q4Z8TcD6EFiC-102" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-40" value="Snooping" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3973.08" y="6220" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-57" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-52" target="sthXmhu9q4Z8TcD6EFiC-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-52" value="CPU1 缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4135" y="6190" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-58" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-53" target="sthXmhu9q4Z8TcD6EFiC-54" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-53" value="CPU2 缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4280" y="6190" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-60" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-54" target="sthXmhu9q4Z8TcD6EFiC-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="4465" y="6280" />
              <mxPoint x="4170" y="6280" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-54" value="CPU3 缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4430" y="6190" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-62" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-59" target="sthXmhu9q4Z8TcD6EFiC-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-59" value="将所有缓存连接到CPU片内总线(on-chip bus)上, 进行缓存行访问snooping" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4165" y="6290" width="295" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-61" value="Intel CPU没有invalid queue, 都是直接观测, 自我修改&lt;br&gt;所以不需要read barrier来处理invalid queue" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4180" y="6350" width="265" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-64" value="Write-invalidate" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4575" y="6165" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-65" value="Write-update" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4575" y="6215" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-66" value="强制下一次read获取最新值" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4675" y="6165" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-67" value="实时更新最新值" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4675" y="6215" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-68" value="Physical Memory" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4110" y="6460" width="60" height="190" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-71" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-69" target="sthXmhu9q4Z8TcD6EFiC-70" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-69" value="MTRR" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4270" y="6530" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-70" value="可以指定哪一段内存区域用哪个模型&lt;br&gt;是write back还是write through, 还是uncachable" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4390" y="6527.5" width="180" height="45" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-73" value="write through在写入内存时, 数据要传输到内存, 所以会占用内存总线周期, 从而导致总线利用率下降" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="4260" y="6610" width="380" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-76" value="Memory" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3708.5" y="6480" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-80" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-77" target="sthXmhu9q4Z8TcD6EFiC-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-77" value="缓存行是否会发生数据冲突? 是的&lt;br&gt;若发生冲突, 新的数据要写入, 老的数据怎么办?" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3432.75" y="6389" width="237.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-78" value="Writeback" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3442" y="6320" width="54" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-82" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-79" target="sthXmhu9q4Z8TcD6EFiC-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-79" value="dirty flag, 如果当前识别为脏缓存行, 要把缓存数据刷进内存" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3387.75" y="6474" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-85" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-81" target="sthXmhu9q4Z8TcD6EFiC-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-81" value="Linux PageCache 与页回收的关系" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3157.75" y="6454" width="168.75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-132" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-84" target="sthXmhu9q4Z8TcD6EFiC-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-84" value="Linux内存管理, 涉及到swapd" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3157.75" y="6509" width="168.75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-86" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3708.5" y="6370" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-87" value="缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3708.5" y="6410" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-88" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3382" y="6650" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-89" value="缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3382" y="6690" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-90" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3527" y="6650" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-91" value="缓存" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3527" y="6690" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-94" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-92" target="sthXmhu9q4Z8TcD6EFiC-91" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-92" value="data" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontFamily=Helvetica;fontSize=11;labelBackgroundColor=default;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="3429" y="6685" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-99" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-93" target="sthXmhu9q4Z8TcD6EFiC-96" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-93" value="一个CPU的cache数据可以转发到另一个CPU的cache中" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3360" y="6725" width="276" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-95" value="Memory" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3387" y="6755" width="215" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-96" value="减少了内存的介入和memory bus的traffic" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3692" y="6740" width="208" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-105" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-102" target="sthXmhu9q4Z8TcD6EFiC-104" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-102" value="网络安全相关" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3835.46" y="6190" width="75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-104" value="扫描 + 嗅探" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3728.5" y="6160" width="66.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-108" value="MESI" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3602" y="7000" width="41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-109" value="缓存一致性协议" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3573.5" y="6930" width="107" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-110" value="Modified" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3734.75" y="6940" width="41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-111" value="Exclusive" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3735" y="6980" width="41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-112" value="Shared" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3734.75" y="7020" width="41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-113" value="Invalid" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3734.75" y="7060" width="41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-114" value="由于Intel cpu的MESI协议使用snooping, 于是不需要使用invalida queue, 简化了上面讲的cpu抽象模型" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3573.5" y="7110" width="261.96" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-119" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-116" target="sthXmhu9q4Z8TcD6EFiC-118" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-116" value="Swap Space" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3050" y="6510" width="68.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-118" value="Swap Storm" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=#FF3333;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2920" y="6455" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-120" value="如果频繁发生Cache Thrashing, 那么说明缓存行被频繁的换进换出内存, 那么此时可以采用的: huge pages, 减少PTE的数量, 增加了TLB缓存命中率, 减少了page fault, 减少page的换进换出" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2788" y="6590" width="322" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-121" value="这个是软件层面的优化, 通过缓存行填充, 避免2个变量共享一个缓存行导致的False Sharing" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2745" y="6880" width="322" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-127" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-122" target="sthXmhu9q4Z8TcD6EFiC-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-122" value="Intel CPU的cache line fill" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2526.25" y="6830" width="143.75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-128" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-123" target="sthXmhu9q4Z8TcD6EFiC-121" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-123" value="软件层面的cache line fill" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2529.5" y="6885" width="136.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-124" value="这个指的是cpu会利用spatial locality, 从内存中读取数据时, 会读一定量的数据(e.g. 64 bytes)填满一个cache line" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2745" y="6825" width="322" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-125" value="False Sharing意思是: 2个或多个线程共享一个缓存行, 但是它们却访问更新缓存行中的不同数据, 导致缓存一致性协议频繁产生线程所属CPU缓存的同步更新" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=#FF0000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2679" y="6935" width="468.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-129" value="Memory Controller" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3947.5" y="6310" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-130" value="Integrated Memory Controller (IMC)" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3919.33" y="6340" width="177.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-136" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-133" target="sthXmhu9q4Z8TcD6EFiC-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-137" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-133" target="sthXmhu9q4Z8TcD6EFiC-135" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-133" value="CPU乱序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="622" y="3846.25" width="100.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-194" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-134" target="51N8JspCCHDJ9Vv9rA9t-192" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-195" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-134" target="51N8JspCCHDJ9Vv9rA9t-193" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-134" value="MOB乱序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="814.75" y="3790.75" width="100.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-135" value="CPU执行乱序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="819.75" y="3892" width="100.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-160" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-142" target="sthXmhu9q4Z8TcD6EFiC-158" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-142" value="Compiler乱序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="278.75" y="4345" width="100.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-147" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-143" target="sthXmhu9q4Z8TcD6EFiC-144" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-143" value="语言" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="500" y="4200" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-148" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-144" target="sthXmhu9q4Z8TcD6EFiC-145" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-144" value="Compiler" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="594" y="4200" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-149" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-145" target="sthXmhu9q4Z8TcD6EFiC-146" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-145" value="ISA" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="743" y="4200" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-146" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="839" y="4200" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-150" value="优化导致的乱序" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF0000;" parent="1" vertex="1">
          <mxGeometry x="652" y="4190" width="91" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-154" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=90;" parent="1" vertex="1">
          <mxGeometry x="774" y="3830.75" width="20" height="304" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-67" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;dashed=1;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-155" target="sthXmhu9q4Z8TcD6EFiC-157" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-155" value="CPU 屏障指令" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="725.5" y="3993.75" width="117" height="20" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-156" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=-90;" parent="1" vertex="1">
          <mxGeometry x="685" y="4082.5" width="20" height="197" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-157" value="编译器屏障" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="667" y="4149.5" width="61" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-172" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-161" target="sthXmhu9q4Z8TcD6EFiC-162" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-161" value="Java" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="480" y="4370" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-173" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-162" target="sthXmhu9q4Z8TcD6EFiC-163" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-71" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-162" target="51N8JspCCHDJ9Vv9rA9t-69" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-162" value="JMM" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="578.25" y="4370.5" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-171" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-163" target="sthXmhu9q4Z8TcD6EFiC-165" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-163" value="JVM" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="694.5" y="4370.5" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-164" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-165" target="sthXmhu9q4Z8TcD6EFiC-167" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-165" value="Compiler" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="813.51" y="4370.5" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-166" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-167" target="sthXmhu9q4Z8TcD6EFiC-168" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-167" value="ISA" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="914" y="4369.5" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-168" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1010" y="4369.5" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-174" value="如何让Java程序员规避JVM后续的复杂底层问题, 引入JMM的规范;&lt;br&gt;JVM的开发者需要遵循JMM的规范来开发虚拟机" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="487.25" y="4324.5" width="398.5" height="45" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-176" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="sthXmhu9q4Z8TcD6EFiC-175" target="sthXmhu9q4Z8TcD6EFiC-165" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-175" value="C语言" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="694.5" y="4435" width="55" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-178" value="Compiler barrier" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-480" y="4670.75" width="125" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-179" value="CPU memory barrier" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-480" y="4718.75" width="125" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sthXmhu9q4Z8TcD6EFiC-180" value="MMIO write barrier" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-480" y="4775.25" width="125" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-2" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=90;" parent="1" vertex="1">
          <mxGeometry x="882.5" y="4357.5" width="20" height="152" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-3" target="51N8JspCCHDJ9Vv9rA9t-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-8" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-3" target="51N8JspCCHDJ9Vv9rA9t-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-3" value="编译器屏障" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="861" y="4444.5" width="65" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-4" value="#define barrier() __asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="638" y="4545" width="313" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-6" value="#define ACCESS_ONCE(x) (*(volatile typeof(x) *)&amp;amp;(x))&lt;br&gt;限制单个变量: &quot;don&#39;t optimize or reorder accesses to this variable&quot;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=12;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="963.5" y="4545" width="294" height="65" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-7" value="Mandatory barrier" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-345" y="4631.75" width="125" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-11" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-9" target="51N8JspCCHDJ9Vv9rA9t-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-14" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-9" target="51N8JspCCHDJ9Vv9rA9t-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-16" value="&lt;font style=&quot;font-size: 21px;&quot; color=&quot;#ff3333&quot;&gt;&lt;b style=&quot;&quot;&gt;X&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="51N8JspCCHDJ9Vv9rA9t-14" vertex="1" connectable="0">
          <mxGeometry x="0.1563" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-9" value="STORE A; STORE B; LOCK; LOAD A; LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3236.5" y="5241" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-10" value="LOCK; STORE A; STORE B; LOAD A; LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3124.75" y="5322" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-12" value="允许LOCK前面的操作重排序到LOCK后, 但是不允许LOCK后续的操作重排序到LOCK前面" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2823" y="5299.5" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-13" value="STORE A; STORE B; LOAD A; LOAD B; LOCK;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3428" y="5322" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-18" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-21" target="51N8JspCCHDJ9Vv9rA9t-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-19" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-21" target="51N8JspCCHDJ9Vv9rA9t-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-20" value="&lt;font style=&quot;font-size: 21px;&quot; color=&quot;#ff3333&quot;&gt;&lt;b style=&quot;&quot;&gt;X&lt;/b&gt;&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="51N8JspCCHDJ9Vv9rA9t-19" vertex="1" connectable="0">
          <mxGeometry x="0.1563" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-21" value="STORE A; STORE B; UNLOCK; LOAD A; LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3222.25" y="5470.75" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-22" value="UNLOCK; STORE A; STORE B; LOAD A; LOAD B" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3110.5" y="5551.75" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-23" value="UNLOCK的顺序是相反的, 允许后续的操作重排序到UNLOCK之前" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="2818" y="5500.75" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-24" value="STORE A; STORE B; LOAD A; LOAD B; UNLOCK;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3413.75" y="5551.75" width="252.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-27" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=90;" parent="1" vertex="1">
          <mxGeometry x="3231.75" y="5230" width="20" height="810" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-35" value="一言以蔽之: 就是允许其他代码进入LOCK和UNLOCK的控制代码范围;&amp;nbsp;&lt;br&gt;因为在这两个指令间的代码一定是位于critical section, 所以他们不能移动到锁的控制范围外, while锁外部的代码是允许进入这个范围的" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="3042" y="5670" width="389.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-38" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-36" target="51N8JspCCHDJ9Vv9rA9t-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-36" value="The Alpha defines the Linux kernel&#39;s memory barrier model." style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="451.5" y="4646" width="305" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-37" value="Alpha CPU是乱序最严重的CPU, 所以kernel要兼容这个最差情况" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="792.75" y="4646" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-41" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-39" target="51N8JspCCHDJ9Vv9rA9t-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-39" value="volatile" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=#FF0000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="385" y="4703.5" width="47.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-43" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-40" target="51N8JspCCHDJ9Vv9rA9t-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-40" value="gcc编译器要对这个关键字采取一定的策略" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="484" y="4703.5" width="216" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-51" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-42" target="51N8JspCCHDJ9Vv9rA9t-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-42" value="不要优化volatile的变量, 每次都从内存读值" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="513.25" y="4768.5" width="216.75" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-44" value="#define barrier() __asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="659" y="4893.5" width="313" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-52" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-46" target="51N8JspCCHDJ9Vv9rA9t-44" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-46" value="如果我某段代码允许优化呢? volatile是不是粒度太大了" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="576.2500000000001" y="4826.5" width="277.38" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-48" value="代码段&lt;br&gt;(允许编译器优化)" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="555" y="4960.75" width="96.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-49" value="代码段&lt;br&gt;(不允许优化)" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="694.9999999999999" y="4960.75" width="101.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-50" value="代码段&lt;br&gt;(不允许优化)" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="839.81" y="4960.75" width="101.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-53" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;rotation=-90;" parent="1" vertex="1">
          <mxGeometry x="801.25" y="4812" width="20" height="257.5" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-56" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-54" target="51N8JspCCHDJ9Vv9rA9t-55" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-61" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-54" target="51N8JspCCHDJ9Vv9rA9t-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-54" value="在C语言中, 编译器可能会把while (a == 1) {} 这样一个循环直接优化为一直跳转同一个地址, 所以可能吧不会探查到a值的改变, 从而进入死循环" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="354.56" y="5069.5" width="387" height="51" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-59" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-55" target="51N8JspCCHDJ9Vv9rA9t-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-55" value="解决方法是: 1. volatile; 2 加编译器屏障" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="801.31" y="5075.37" width="220.5" height="39.25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-63" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-58" target="51N8JspCCHDJ9Vv9rA9t-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-58" value="同理可知, 在Java中, 循环无法退出的原因也是JIT编译器在运行时优化了这个循环代码, 因此可以通过-Xint让JVM关闭C1,C2的优化, 纯解释执行bytecode来验证" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="690.19" y="5209.5" width="442.75" height="39.25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-65" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-60" target="51N8JspCCHDJ9Vv9rA9t-64" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-60" value="如果是由于MOB导致的短暂visibility问题, 那么总有一刻, 这个更新值会被CPU同步并可见, 导致循环退出, 但实际情况并不是这样" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF0000;" parent="1" vertex="1">
          <mxGeometry x="399.56" y="5148.5" width="297" height="48.25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-62" value="volatile可以阻止编译器优化" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="824.81" y="5279.5" width="172" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-64" value="因此, 我们可以说, CPU的指令执行不会存在可见性的问题 (就算有也是暂时性的)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF0000;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="342" y="5232" width="315" height="28.25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-68" value="CPU 屏障指令一定是兼具编译器屏障的功能的" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="761.5" y="4072" width="267" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-73" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-69" target="51N8JspCCHDJ9Vv9rA9t-72" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-69" value="volatile" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="573.25" y="4460" width="65" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-76" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-72" target="51N8JspCCHDJ9Vv9rA9t-74" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-77" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-72" target="51N8JspCCHDJ9Vv9rA9t-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-72" value="JMM约定了: volatile不允许重排序&lt;br&gt;所以JVM的impl e.g. hotspot 不管怎么实现都要保证这个语义" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="227.25" y="4455" width="205" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-79" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-74" target="51N8JspCCHDJ9Vv9rA9t-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-74" value="不允许编译器重排序" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="4407.5" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-80" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-75" target="51N8JspCCHDJ9Vv9rA9t-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-75" value="不允许CPU乱序" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="4490" width="120" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-78" value="Java的volatile = 编译器屏障 + CPU屏障" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-230" y="4455" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-86" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-81" target="51N8JspCCHDJ9Vv9rA9t-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-81" value="程序编写顺序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="59.75" y="5370" width="100.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-87" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-82" target="51N8JspCCHDJ9Vv9rA9t-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-82" value="编译器顺序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="204.75" y="5370" width="100.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-83" value="CPU执行顺序" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="354.56" y="5370" width="100.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-85" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-84" target="51N8JspCCHDJ9Vv9rA9t-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-84" value="语言的编码顺序" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF0000;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-80" y="5371.75" width="105" height="28.25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-92" value="If one action happens before another, then the first is visible to and ordered before the second" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="342" y="5475.5" width="378" height="39" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-97" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-94" target="51N8JspCCHDJ9Vv9rA9t-95" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-94" value="JMM的定义(规范)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="23" y="5485" width="112" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-135" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-98" target="51N8JspCCHDJ9Vv9rA9t-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-98" value="JVM impl" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="200.44" y="5680" width="104.56" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-104" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-101" target="51N8JspCCHDJ9Vv9rA9t-103" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-101" value="A write to a volatile field happens before every subsequent read of that volatile." style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="343.06" y="5540" width="386.94" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-103" value="根据Happens-Before的定义可知: 对volatile field的write先发生, 且对后续的所有read都可见" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="386.06" y="5610" width="443.94" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-105" value="简而言之, JMM定义了一些规则, JVM实现要满足这些规则, Java开发者要按照这个规则编码" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="55" y="5755" width="300" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-107" value="final的语义: 在constructor执行结束后, final的field对其他线程/CPU一定可见&lt;br&gt;&amp;nbsp;---&amp;gt; 在constructor执行结束后, 有一个full barrier" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-44.41" y="5840" width="387.47" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-111" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-109" target="51N8JspCCHDJ9Vv9rA9t-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-109" value="JSR-133 is effectively an addition and a revision to the original Java Memory Model (JMM)." style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1052.25" y="5500" width="467" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-110" value="All JVM implementations starting from Java 5 (when JSR-133 was introduced) are required to adhere to the updated Java Memory Model (JMM) as defined by JSR-133. This compliance is a part of the Java Language Specification (JLS)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1028.5" y="5562" width="515" height="58" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-114" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-112" target="51N8JspCCHDJ9Vv9rA9t-109" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-112" value="The pre-JSR-133 JMM was indeed relaxed in that it failed to provide sufficient guarantees for memory visibility and ordering, making concurrent programming highly error-prone. JSR-133 addressed these issues by introducing a clear and robust memory model that aligns with modern hardware and multi-threading requirements" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="1046.25" y="5395" width="479" height="65" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-119" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-117" target="51N8JspCCHDJ9Vv9rA9t-118" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-117" value="synchronized:&amp;nbsp;&lt;br&gt;&amp;nbsp;- Unlock the monitor: release&lt;br&gt;&amp;nbsp;- Lock the monitor: acquire" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="410" y="5700" width="150" height="45" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-118" value="Some operations (e.g., writing a volatile variable, unlocking a monitor, starting a thread) have release semantics: they allow the actions that happen before the release to be visible to and ordered before following actions. Other operations (e.g., reading a volatile variable, locking a monitor) have acquire semantics: they allow actions in a different thread to see and be ordered after earlier actions." style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="391.5" y="5810" width="499" height="70" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-129" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-120" target="51N8JspCCHDJ9Vv9rA9t-121" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-131" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-120" target="51N8JspCCHDJ9Vv9rA9t-122" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-132" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-120" target="51N8JspCCHDJ9Vv9rA9t-123" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-133" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-120" target="51N8JspCCHDJ9Vv9rA9t-124" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-120" value="JVM memory barrier operations" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-515" y="5600" width="165" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-121" value="LoadLoad:&amp;nbsp; &amp;nbsp;Load1(s); LoadLoad; Load2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-295.23" y="5540" width="207.47" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-122" value="StoreStore: Store1(s); StoreStore; Store2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-298.99" y="5590" width="215" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-123" value="LoadStore:&amp;nbsp; Load1(s); LoadStore; Store2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-299" y="5635" width="215" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-124" value="StoreLoad:&amp;nbsp; Store1(s); StoreLoad; Load2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-299" y="5680" width="215" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-136" value="JVM通过定义和实现一系列barrier ops确保了memory ordering, 来满足JMM定义的Happens-Before规则" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FF0000;" parent="1" vertex="1">
          <mxGeometry x="-55" y="5575" width="265" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-137" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;Volatile Write&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="881.81" y="5970" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-138" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;StoreLoad&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="881.81" y="6020" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-139" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;Volatile Read&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="706.05" y="5970" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-140" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;LoadLoad&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="706.05" y="6020" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-141" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;LoadStore&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="706.05" y="6070" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-142" value="&lt;span style=&quot;font-size: 12px; background-color: rgb(251, 251, 251);&quot;&gt;StoreStore&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="881.8" y="5920" width="115" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-145" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-143" target="51N8JspCCHDJ9Vv9rA9t-144" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-143" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;Unsafe&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=#CC0000;fillColor=#CC0000;" parent="1" vertex="1">
          <mxGeometry x="328.39" y="6090" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-144" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;JNI&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=#FF9933;fillColor=#FF9933;" parent="1" vertex="1">
          <mxGeometry x="473.39" y="6090" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-146" value="lazySet =&amp;gt; unsafe.putOrderedXXX 只保证写和写的顺序, 不保证可见行; &lt;br&gt;相当于保证按顺序写到CPU storebuffer, 但是不刷" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="255.26" y="6155" width="393.74" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-149" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-147" target="51N8JspCCHDJ9Vv9rA9t-148" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-147" value="volatile int a = 1;&lt;br&gt;int b = a;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-154.41" y="5980" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-152" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-148" target="51N8JspCCHDJ9Vv9rA9t-150" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-153" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-148" target="51N8JspCCHDJ9Vv9rA9t-151" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-148" value="写一次a, 再读一次a赋值给b; &lt;br&gt;涉及volatie变量的写和读" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-8.5" y="5980" width="158.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-156" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-150" target="51N8JspCCHDJ9Vv9rA9t-155" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-150" value="getfield" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="210" y="5960" width="59.56" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-157" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-151" target="51N8JspCCHDJ9Vv9rA9t-155" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-151" value="putfield" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="210" y="6005" width="59.56" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-162" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-155" target="51N8JspCCHDJ9Vv9rA9t-161" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-155" value="解释器" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="355" y="5980" width="91.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-158" value="如果直接调用Unsafe操作, 可以越过解释器, 操作一个non-volatile变量实现JMM规定的volatile的语义" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="236.26" y="6050" width="393.74" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-159" value="int a可以不加volatile吗?&amp;nbsp;&lt;br&gt;因为我可以通过直接调用Unsafe, 来调用JNI来保证可见性" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="-183.3" y="6060" width="293.3" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-163" value="解释器可以按照这个barrier的使用, 来满足volatile的语义" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="451.5" y="5950" width="178.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-164" value="AQS" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-460" y="6419" width="590" height="31" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-169" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-166" target="dpeUAHpxACgYPMOwfueQ-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-166" value="Thread1" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="496" y="690" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-168" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-167" target="dpeUAHpxACgYPMOwfueQ-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-167" value="Thread2" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="606" y="690" width="70" height="40" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-178" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-170" target="51N8JspCCHDJ9Vv9rA9t-173" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-170" value="FairSync vs NonfairSync" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-365" y="6580" width="135" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-172" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-171" target="51N8JspCCHDJ9Vv9rA9t-170" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-171" value="AQS" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-365" y="6530" width="135" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-176" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-173" target="51N8JspCCHDJ9Vv9rA9t-174" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-173" value="是否查看线程排队" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-365" y="6630" width="135" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-174" value="非公平锁性能更好, 减少去内核中阻塞的线程数量" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-365" y="6680" width="135" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-181" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-179" target="51N8JspCCHDJ9Vv9rA9t-180" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-179" value="1, 多线程进入队列, 如何保证线程安全&lt;br&gt;2, 进入队列后, 锁释放了怎么办?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-154.41" y="6630" width="204.41" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-180" value="1, 使用原子性指令, 在队列中操作保证前后指针的原子性&lt;br&gt;2, 进入队列后, 进入OS阻塞前, 再次判断锁状态" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="84" y="6628.13" width="295" height="33.75" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-185" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-182" target="51N8JspCCHDJ9Vv9rA9t-183" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-182" value="wait set" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="790" y="5675" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-183" value="Object.wait, Object.notify, Object.notifyAll" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="901" y="5679" width="234" height="17" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-186" value="JUC 第18节" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-60" y="6424" width="90" height="21" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-187" value="只有OS能阻塞线程, 所以必须通过syscall" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-515" y="6680" width="135" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-188" value="&lt;div&gt;static final Node EXCLUSIVE = null;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="89.56" y="6740" width="189.2" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-189" value="AQS Node" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-72.5" y="6750" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-190" value="&amp;nbsp; static final Node SHARED = new Node();" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="85" y="6775" width="215" height="30" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-191" value="抽象CPU模型" style="ellipse;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=13;fontColor=#000000;labelBackgroundColor=#FFCC99;fontStyle=1;fillColor=#FFCC99;" parent="1" vertex="1">
          <mxGeometry x="1106" y="3450" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-192" value="写入乱序" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="953.75" y="3762" width="95" height="37" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-193" value="读取乱序" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="953.75" y="3828" width="95" height="37" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-196" value="CPU读数据从哪里读? cache中, 那么如果没有一种机制保证cache的数据更新, 是不是CPU就会读到旧数据" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2171" y="3812" width="444.5" height="38" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-197" value="WAL: Write-Ahead Logging" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-613.3" y="6790" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-200" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-198" target="51N8JspCCHDJ9Vv9rA9t-199" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-198" value="MQ" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-593.3" y="6840" width="115" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-199" value="磁盘" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-447.05" y="6840" width="62.5" height="35" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-201" value="MQ的数据要持久化, 没法每条数据进来我都写一次磁盘, 否则磁盘IO太多, 性能受损。&lt;br&gt;所以MQ通过利用OS的page cache, 先把数据写入内存, 然后定期落盘一次。&lt;br&gt;那么问题: 如果MQ写了一些数据在内存, 还没到下一次落盘的操作时, 挂了, 那写入内存的数据就丢了? 所以在写入内存之前, 要写日志, 确保我的日志落盘了, 这样如果发生crash, 我可以通过持久化的日志内容来找回" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-650" y="6900" width="465" height="80" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-203" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-753.3" y="6847.5" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-204" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-713.3" y="6847.5" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-207" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-205" target="51N8JspCCHDJ9Vv9rA9t-198" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-205" value="" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-673.3" y="6847.5" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-213" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-208" target="51N8JspCCHDJ9Vv9rA9t-209" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-214" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-208" target="51N8JspCCHDJ9Vv9rA9t-210" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-240" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-208" target="51N8JspCCHDJ9Vv9rA9t-239" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-208" value="waitStatus" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="85" y="6835" width="65" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-212" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-209" target="51N8JspCCHDJ9Vv9rA9t-211" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-209" value="SIGNAL" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="225" y="6850" width="55" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-210" value="CANCELLED" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="225" y="6810" width="75" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-211" value="queue中正常的状态, 要负责唤醒后面的node" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="317.06" y="6850" width="222.94" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-215" value="互斥区" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-72.5" y="7100" width="135" height="50" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-220" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-216" target="51N8JspCCHDJ9Vv9rA9t-218" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-216" value="线程之间存在数据竞争的唯一要素: 存在写线程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-136.47" y="7160" width="242.94" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-217" value="String类: final, 修改就生成新的String, 之前的String完全不受影响, 解决了写线程的问题, 直接避免了多个线程修改同一个数据的情况" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-6.68" y="7220" width="246.68" height="50" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-5" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" edge="1" parent="1" source="51N8JspCCHDJ9Vv9rA9t-218" target="51N8JspCCHDJ9Vv9rA9t-228">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-218" value="读多写少的情况, 有必要用互斥锁吗?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="173.23" y="7135" width="186.77" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-224" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-222" target="51N8JspCCHDJ9Vv9rA9t-215" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-222" value="只有一个线程能执行互斥区代码" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-93.24" y="7030" width="176.47" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-225" value="互斥区" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="459.5" y="7150" width="135" height="50" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-226" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-227" target="51N8JspCCHDJ9Vv9rA9t-225" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-227" value="读线程共享互斥区, 写线程独占" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="447.89" y="7062.5" width="158.22" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-230" value="共享锁" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="442.3" y="7090" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-231" value="互斥锁" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="526.6999999999999" y="7090" width="85" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-236" value="互斥锁" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-42.5" y="7062.5" width="75" height="20" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-242" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-239" target="51N8JspCCHDJ9Vv9rA9t-241" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-239" value="PROPAGATE" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="220" y="6895" width="74.78" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-241" value="由于共享锁的存在, 当唤醒队列中的线程, 需要把这个唤醒状态传播给队列中其他的读线程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="321.66" y="6895" width="268.34" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-245" value="" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" parent="1" source="51N8JspCCHDJ9Vv9rA9t-243" target="51N8JspCCHDJ9Vv9rA9t-244" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-243" value="读写锁如何避免写饥饿?" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="685" y="7105" width="125" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-244" value="读线程进queue时如果前面有写线程在排队, 不要抢锁, 去排队" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="851.81" y="7105" width="298.19" height="25" as="geometry" />
        </mxCell>
        <mxCell id="51N8JspCCHDJ9Vv9rA9t-246" value="锁升级: 读锁升级为写锁, 持有读锁没办法直接获取写锁/互斥锁, 没法直接升级, 所以只能先释放读锁, 再去尝试获取写锁/互斥锁&lt;br&gt;&lt;br&gt;锁降级: 写锁降级为读锁; 可以先获取读锁, 再释放写锁" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="690" y="7170" width="375" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-1" value="需要统计每个读线程的重入次数, 那么由于读线程可能存在多个, 不能像只有一个互斥线程可以直接 + state, 所以理应使用ThreadLocal来记录线程自己的读锁重入次数; 但是有可能只有一个读线程, 那么直接将其记录在读写锁的变量中即可" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="362.96999999999997" y="7430" width="438.34" height="50" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="l8XCwNJ57m56pEhpH9Ja-2" target="l8XCwNJ57m56pEhpH9Ja-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-2" value="读线程用ThreadLocal记录自己的读锁重入次数" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="465.27" y="7360" width="233.74" height="30" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-4" value="firstReader来处理一种特殊情况: firstReader是第一个获取ReadLock的线程, 是第一个把share state从0变1的; 如果只有一个读线程, 那么此时获取重入计数的代价会较低" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="774.01" y="7350" width="338.74" height="50" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-7" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" edge="1" parent="1" source="l8XCwNJ57m56pEhpH9Ja-6" target="l8XCwNJ57m56pEhpH9Ja-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-6" value="每个获取读锁的线程都要直接操作state变量的高16位, 但是如何统计每个读线程的重入次数呢?" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="412.77000000000004" y="7280" width="338.74" height="40" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-8" value="acquire" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="-890" y="7360" width="75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-9" value="addWaiter" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="-755" y="7320" width="75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-10" value="ReadWriteLock" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="442.89" y="7020" width="158.22" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-11" value="ReentrantLock" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="-80" y="7005" width="158.22" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-14" style="edgeStyle=orthogonalEdgeStyle;shape=connector;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=default;align=center;verticalAlign=middle;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;endArrow=classic;" edge="1" parent="1" source="l8XCwNJ57m56pEhpH9Ja-12" target="l8XCwNJ57m56pEhpH9Ja-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-12" value="Semaphore" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="-42.5" y="7550" width="92.5" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l8XCwNJ57m56pEhpH9Ja-13" value="一个有计数的共享锁;&amp;nbsp;&lt;br&gt;如果计数为1, 就可以认为等同于互斥锁" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=Helvetica;fontSize=11;fontColor=default;labelBackgroundColor=default;" vertex="1" parent="1">
          <mxGeometry x="105.88000000000001" y="7540" width="198.24" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
