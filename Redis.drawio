<mxfile host="app.diagrams.net" modified="2022-10-16T17:01:44.605Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36" etag="REmNIX_lnNpvPVNdIkop" version="20.4.0" type="github">
  <diagram id="zUd6xa0raMeIInKoFcpr" name="Page-1">
    <mxGraphModel dx="-1695" dy="416" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gHjb5b28OfsgwWgYxNie-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="gHjb5b28OfsgwWgYxNie-1" target="gHjb5b28OfsgwWgYxNie-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-7" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="gHjb5b28OfsgwWgYxNie-1" target="gHjb5b28OfsgwWgYxNie-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="Redis" id="gHjb5b28OfsgwWgYxNie-1">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
            <mxGeometry x="2714" y="609.32" width="100" height="42.5" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="setsid" link="https://unix.stackexchange.com/questions/240646/why-we-use-setsid-while-daemonizing-a-process" id="gHjb5b28OfsgwWgYxNie-2">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
            <mxGeometry x="2990" y="328.84999999999997" width="80" height="23.72" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="gHjb5b28OfsgwWgYxNie-3" value="&lt;font color=&quot;#ff3333&quot;&gt;数据结构 + 事件循环&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2700" y="575.13" width="128" height="25" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-4" value="数据结构" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="2994" y="515.3900000000001" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-5" value="事件循环" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3010" y="830" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-11" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gHjb5b28OfsgwWgYxNie-9" target="gHjb5b28OfsgwWgYxNie-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-9" value="内存数据库的设计什么最重要? 效率 + 内存利用率" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2570" y="80" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-13" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="gHjb5b28OfsgwWgYxNie-10" target="gHjb5b28OfsgwWgYxNie-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-10" value="让redis自身表示的数据尽可能小, 所以想方设法搞出一堆节约内存资源的操作" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2580" y="150" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-12" value="将一个基本类型拆分成多个不同的位域&lt;br&gt;e.g 一个int的不同范围各有作用" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2582.5" y="210" width="275" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-15" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2930" y="80" width="130" height="160" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-16" value="元数据" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FF6666;" parent="1" vertex="1">
          <mxGeometry x="2930" y="80" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-17" value="用户数据" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="2930" y="130" width="130" height="110" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-19" value="Redis如何保持daemon进程一直运行" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="2720" y="320" width="220" height="42.57" as="geometry" />
        </mxCell>
        <mxCell id="gHjb5b28OfsgwWgYxNie-20" value="daemonizing a process" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="3080" y="326.86" width="140.88" height="25.71" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-1" value="string" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3208" y="427.5000000000001" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-2" value="hash" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3208" y="583.5100000000001" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-3" value="set" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3208" y="506.70000000000005" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-4" value="sorted set(zset)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3208" y="542.4999999999999" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-5" value="list" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" parent="1" vertex="1">
          <mxGeometry x="3208" y="467.5" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-7" value="&lt;p&gt;typedef struct redisObject {&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; unsigned type:4;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; unsigned notused:2;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; unsigned encoding:4;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; unsigned lru:22;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; int refcount;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; void *ptr&lt;br&gt;} robj;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="3440" y="459.61" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="0TQrHJX6QjW9VzBPeowM-8" value="这里的ptr指针类似于接口, 是一个共享的抽象表示, 实际指向的位置是某个真正的数据结构" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF6666;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="3360" y="590" width="360" height="47.43" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-1" value="OS模块" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" vertex="1" parent="1">
          <mxGeometry x="3100" y="1030" width="147" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-3" value="3-6" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="2960" y="960" width="520" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="vs6chZFLeiXoNTxb_euZ-6" target="vs6chZFLeiXoNTxb_euZ-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-6" value="&lt;span style=&quot;font-family: Verdana;&quot;&gt;Logical Address&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3017" y="1115.81" width="116" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="vs6chZFLeiXoNTxb_euZ-7" target="vs6chZFLeiXoNTxb_euZ-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-7" value="&lt;span style=&quot;font-family: Verdana;&quot;&gt;Virtual Address&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3287" y="1115.8000000000002" width="116" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="vs6chZFLeiXoNTxb_euZ-8" target="vs6chZFLeiXoNTxb_euZ-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-8" value="GDTR" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" vertex="1" parent="1">
          <mxGeometry x="3160" y="1117.9" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="vs6chZFLeiXoNTxb_euZ-12" target="vs6chZFLeiXoNTxb_euZ-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-12" value="Page Table" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" vertex="1" parent="1">
          <mxGeometry x="3429" y="1117.9" width="100" height="25.81" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-13" value="&lt;span style=&quot;font-family: Verdana;&quot;&gt;Physical Address&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3556" y="1115.8000000000002" width="116" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-17" value="ELF" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" vertex="1" parent="1">
          <mxGeometry x="3030" y="1230" width="116" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-18" value="OS模块" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontFamily=Verdana;align=center;" vertex="1" parent="1">
          <mxGeometry x="3213" y="1225" width="147" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-19" value="任务串行" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3000" y="1410" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-20" value="分时复用" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3000" y="1500" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-21" value="CPU执行任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3090" y="1350" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-22" value="时延Latency: 一个任务从开始执行, 到结束执行的时间" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3414" y="1290" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-23" value="吞吐量Throughput: 给定一个时间范围, 计算该范围内完成的总任务数 . e.g QPS, TPS" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3414" y="1310" width="470" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-26" value="假设只有一个CPU, 多个程序, 控制单元和计算单元, 存储单元只有一套, 怎么复用?&lt;br&gt;&lt;br&gt;1.控制单元: 可以直接复用&lt;br&gt;2.计算单元: 可以直接复用, fetch-decode-execute是atomic&lt;br&gt;3.存储单元(寄存器): 不可以直接复用, 需要&quot;同步操作&quot;, 是critical section =&amp;gt; 上下文切换" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="3010" y="1550" width="470" height="110" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-28" value="&lt;font color=&quot;#ff3333&quot;&gt;时钟中断&lt;/font&gt;是怎么来的? 通过信号让CPU迎角的电平高低变化, 即通知CPU产生了中断; 这个中断信号是定期产生, 但是CPU不是每次都处理, 在一个指令的执行周期(fetch, decode, execute)内, , CPU都不响应这些中断信号, 只有在计算数据要写回内存时, CPU才处理中断信号; 所以是在一条机器指令的指令周期末尾, 才对中断进行处理。&lt;br&gt;&lt;br&gt;总而言之, 一条机器指令的执行(instruction cycle)是不会被中断的; 这个执行过程包括: fetch(取指令) , decode(根据指令意图决定要不要到内存取数据),&amp;nbsp; execute&lt;br&gt;但是执行之后的数据写回, 是可以被中断的" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="3540" y="1410" width="540" height="130" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-29" value="内存中有多个程序, 操作系统是如何track这些程序, 以及如何拿到这些程序的执行数据?&lt;br&gt;&amp;nbsp;===&amp;gt; 需要描述程序的元数据信息, 比如 程序的段在哪里, 寄存器的信息? ===&amp;gt; 进程&lt;br&gt;&lt;br&gt;ELF是静态程序的元数据, 程序到了内存中, 需要有描述该程序的动态元数据, 此时程序在内存中的动态元数据 + ELF中的静态元数据 ===&amp;gt; 进程" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="3010" y="1709" width="470" height="89" as="geometry" />
        </mxCell>
        <mxCell id="vs6chZFLeiXoNTxb_euZ-30" value="具像化到Linux:&lt;br&gt;用struct task_struct {} 表示程序在内存中的元数据信息" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="3575" y="1700" width="305" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
